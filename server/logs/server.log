{"level":"info","time":"2026-02-19T22:12:51.895Z","pid":16440,"hostname":"il-dev-win-lt-shahar-pot","clientId":"ws-1771538270495-symnj2","code":1000,"reason":"IDLE_TIMEOUT","wasClean":true,"msg":"websocket_disconnected"}
{"level":"info","time":"2026-02-19T22:12:52.963Z","pid":16440,"hostname":"il-dev-win-lt-shahar-pot","traceId":"c14067cc-2737-4f37-809e-887c5aa9c8bb","sessionId":"sess_a5e2fc84-6436-4048-9eaa-8357d8fbd9ad","hasUserId":false,"ticketHash":"fd0707243e7f","ttl":60,"msg":"[WSTicket] Ticket generated"}
{"level":"info","time":"2026-02-19T22:12:52.976Z","pid":16440,"hostname":"il-dev-win-lt-shahar-pot","clientId":"ws-1771539172976-9uq49k","ip":"::1","originHost":"localhost","sessionHash":"6abce9dceeb7","authMode":"ticket","hasUserId":false,"WS_REQUIRE_AUTH":true,"event":"ws_conn_ctx_set","msg":"WebSocket connection context established"}
{"level":"warn","time":"2026-02-19T22:12:59.436Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","event":"redis_client_not_initialized","pid":22740,"stack":"    at <anonymous> (c:\\dev\\piza\\angular-piza\\server\\src\\middleware\\rate-limit.middleware.ts:148:21)\n    at ModuleJob.run (node:internal/modules/esm/module_job:195:25)","msg":"[Redis] getExistingRedisClient called before initialization - caller should use getRedisClient first"}
{"level":"warn","time":"2026-02-19T22:12:59.445Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","rateLimitStore":"memory","msg":"[RateLimit] Using in-memory rate limiting (not distributed)"}
{"level":"info","time":"2026-02-19T22:12:59.480Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","event":"CACHE_INIT_ATTEMPT","redisUrl":"redis://localhost:6379","msg":"[GoogleMapsCache] Attempting Redis connection"}
{"level":"info","time":"2026-02-19T22:12:59.481Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","event":"GET_REDIS_CLIENT_CALLED","hasExistingInstance":false,"alreadyInitialized":false,"msg":"[Redis] getRedisClient() function entry"}
{"level":"info","time":"2026-02-19T22:12:59.481Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","event":"REDIS_INIT_ATTEMPT","redisUrl":"redis://localhost:6379","useTls":false,"tlsServername":null,"maxRetriesPerRequest":2,"connectTimeout":4000,"commandTimeout":4000,"msg":"[Redis] Attempting connection to shared client"}
{"level":"info","time":"2026-02-19T22:12:59.482Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","event":"REDIS_CLIENT_CREATE_START","msg":"[Redis] About to create Redis client instance"}
{"level":"info","time":"2026-02-19T22:12:59.485Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","event":"REDIS_CLIENT_CREATED","msg":"[Redis] Redis client instance created successfully"}
{"level":"info","time":"2026-02-19T22:12:59.693Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","ttlSeconds":300,"cleanupIntervalMs":60000,"msg":"InMemoryRequestStore initialized"}
{"level":"info","time":"2026-02-19T22:12:59.697Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","event":"redis_init_attempt","pid":22740,"redisUrlHost":"redis://localhost:6379","enableRedisJobStore":true,"enableRedisCache":true,"wsRequiresAuth":true,"retries":3,"connectTimeoutMs":2000,"msg":"[BOOT] Initializing Redis client (required for WS tickets)"}
{"level":"info","time":"2026-02-19T22:12:59.698Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","event":"redis_boot_attempt","attempt":1,"maxAttempts":3,"msg":"[BOOT] Redis connection attempt 1/3"}
{"level":"info","time":"2026-02-19T22:12:59.698Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","event":"GET_REDIS_CLIENT_CALLED","hasExistingInstance":false,"alreadyInitialized":false,"msg":"[Redis] getRedisClient() function entry"}
{"level":"info","time":"2026-02-19T22:12:59.699Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","event":"REDIS_INIT_ATTEMPT","redisUrl":"redis://localhost:6379","useTls":false,"tlsServername":null,"maxRetriesPerRequest":3,"connectTimeout":2000,"commandTimeout":2000,"msg":"[Redis] Attempting connection to shared client"}
{"level":"info","time":"2026-02-19T22:12:59.700Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","event":"REDIS_CLIENT_CREATE_START","msg":"[Redis] About to create Redis client instance"}
{"level":"info","time":"2026-02-19T22:12:59.701Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","event":"REDIS_CLIENT_CREATED","msg":"[Redis] Redis client instance created successfully"}
{"level":"info","time":"2026-02-19T22:12:59.725Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","msg":"[Redis] Client ready"}
{"level":"info","time":"2026-02-19T22:12:59.726Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","msg":"[Redis] Client ready"}
{"level":"info","time":"2026-02-19T22:12:59.727Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","event":"REDIS_CONNECTED","redisUrl":"redis://localhost:6379","msg":"[Redis] ✓ Shared client connected successfully"}
{"level":"info","time":"2026-02-19T22:12:59.728Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","event":"redis_boot_status","ok":true,"redisUrl":"redis://localhost:6379","status":"ready","clientCreated":true,"clientConnected":true,"wsRequiresAuth":true,"msg":"[BOOT] Redis boot status: ✓ CONNECTED"}
{"level":"info","time":"2026-02-19T22:12:59.729Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","event":"session_store_init_start","pid":22740,"msg":"[BOOT] Initializing Redis session store"}
{"level":"info","time":"2026-02-19T22:12:59.729Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","event":"session_store_initialized","ttlSeconds":604800,"keyPrefix":"session:","msg":"[SessionStore] Initialized with Redis backend"}
{"level":"info","time":"2026-02-19T22:12:59.730Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","event":"session_store_initialized","pid":22740,"ttlDays":7,"msg":"[BOOT] ✓ Redis session store ready"}
{"level":"info","time":"2026-02-19T22:12:59.730Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","googleApiKey":{"exists":true,"len":39,"last4":"fpMo"},"searchProvider":"google","msg":"[BOOT] API key status"}
{"level":"info","time":"2026-02-19T22:12:59.730Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","msg":"[Config] ASSISTANT_MODE = ENABLED (always on, LLM-first)"}
{"level":"info","time":"2026-02-19T22:12:59.737Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","env":"development","originsCount":3,"originsSummary":"http://localhost:4200, https://www.going2eat.food, https://app.going2eat.food","credentialsEnabled":true,"msg":"CORS: Initialized"}
{"level":"info","time":"2026-02-19T22:12:59.742Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","path":"/ws","originsCount":3,"originsSummary":"http://localhost:4200, https://www.going2eat.food, https://app.going2eat.food","env":"config_local","redisEnabled":true,"hasStateStore":true,"msg":"WebSocketManager: Configuration resolved"}
{"level":"info","time":"2026-02-19T22:12:59.743Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","redisUrl":"local","msg":"WebSocketManager: Redis enabled"}
{"level":"info","time":"2026-02-19T22:12:59.745Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","path":"/ws","msg":"WebSocketManager: Initialized"}
{"level":"info","time":"2026-02-19T22:12:59.745Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","msg":"Server listening on http://localhost:3000"}
{"level":"info","time":"2026-02-19T22:12:59.747Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","event":"REDIS_CONNECTED","redisUrl":"redis://localhost:6379","msg":"[Redis] ✓ Shared client connected successfully"}
{"level":"info","time":"2026-02-19T22:12:59.747Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","event":"CACHE_SERVICE_READY","hasRedis":true,"commandTimeout":500,"msg":"[GoogleMapsCache] ✓ Cache service active with shared Redis client"}
{"level":"info","time":"2026-02-19T22:13:00.014Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","traceId":"860c1ead-cc9e-4e05-9d00-5103e78bff31","sessionId":"sess_a5e2fc84-6436-4048-9eaa-8357d8fbd9ad","hasUserId":false,"ticketHash":"42c8d289a5d8","ttl":60,"msg":"[WSTicket] Ticket generated"}
{"level":"info","time":"2026-02-19T22:13:00.038Z","pid":22740,"hostname":"il-dev-win-lt-shahar-pot","clientId":"ws-1771539180037-l80khi","ip":"::1","originHost":"localhost","sessionHash":"6abce9dceeb7","authMode":"ticket","hasUserId":false,"WS_REQUIRE_AUTH":true,"event":"ws_conn_ctx_set","msg":"WebSocket connection context established"}
