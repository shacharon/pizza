<div class="wrap">
    <div class="header-row">
        <h1>Chat</h1>
        <div class="query-inline" *ngIf="facade.query() as q">
            <span>City: <b>{{ facade.display(q.city) }}</b></span>
            <span>Type: <b>{{ facade.display(q.type) }}</b></span>
            <span>Max Price: <b>{{ facade.display(q.maxPrice) }}</b></span>
            <span>Dietary: <b>{{ facade.display(q.dietary) }}</b></span>
            <span>ETA: <b>{{ facade.display(q.deliveryEtaMinutes) }}</b></span>
        </div>
    </div>
    <app-chat-log [log]="facade.log()"></app-chat-log>
    <app-chat-composer [(input)]="input" [pending]="facade.pending()" [language]="facade.language()" (send)="send()"
        (languageChange)="facade.language.set($event)"></app-chat-composer>
    <app-guard-note
        [message]="facade.guard() ? (facade.guard()==='off_domain' ? 'Food-only: please specify city, cuisine, and budget.' : 'Policy active: focused on food ordering.') : null"></app-guard-note>
    <app-summary-card [top]="top3()" [pending]="facade.pending()"></app-summary-card>
    <app-refine-chips [chips]="facade.chips()" [disabled]="facade.pending()" (toggle)="toggleChip($event)"
        (clearAll)="clearAllChips()"></app-refine-chips>
    <div *ngIf="facade.error()" class="err">{{ facade.error() }}</div>

    <div *ngIf="facade.hints() as hs" class="hints">
        <button type="button" *ngFor="let h of hs" (click)="pick(h)">{{ h.label }}</button>
    </div>





    <div *ngIf="facade.results() as r" class="results">
        <h2>Results</h2>
        <div class="tables">
            <app-results-table [vendors]="r.vendors" [pending]="facade.pending()" [canLoadMore]="true"
                (loadMore)="loadMore()" />

            <div class="items" *ngIf="false">
                <h3>Items</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Vendor</th>
                            <th>Price</th>
                            <th>Tags</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let i of []">
                            <td>{{ i.name }}</td>
                            <td>{{ i.vendorId }}</td>
                            <td>â‚ª{{ i.price }}</td>
                            <td>{{ (i.tags || []).join(', ') }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>